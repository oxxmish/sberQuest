<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Conent-Type" content="text/html;charset=UTF-8"/>
        <link href="css/style_fields.css" rel="stylesheet" type="text/css"/>
        <title>СберКвест</title>
    </head>

    <body>
        <header>
            <div class="logo">СберКвест</div>
            <div class="role">Администратор</div>
            <div class="profile"><img src="media/profile.jpg" alt=""></div>
        </header>

        <div class="to_fields" @click="go_to_masters" id="to_masters">Ведущие</div>

        <div id="pop_up" class="pop_up" v-if="is_add">
            <div class="pop_up_title">Создание игрового поля</div>
            <input id="pop_up_input" class="pop_up_input" placeholder="Название продукта"></input>
            <div class="pop_up_color_title">Выберите цвет поля</div>
            <div class="pop_up_group_color">
                <div id="color_example">
                    <output id="hex">#000000</output>
                </div>
                <fieldset>
                <label for="r">R</label>
                <input type="range" min="0" max="255" id="r" step="1" value="0">
                <output for="r" id="r_out">0</output>
                </fieldset>  
                
                
                <fieldset>
                <label for="g">G</label>
                <input type="range" min="0" max="255" id="g" step="1" value="0">
                <output for="g" id="g_out">0</output>
                </fieldset>

                
                
                <fieldset>
                <label for="b">B</label>
                <input type="range" min="0" max="255" id="b" step="1" value="0">
                <output for="b" id="b_out">0</output>
                </fieldset>  
                  
                  
            </div>
            <div class="pop_up_group_button">
                <div @click="create_product" class="pop_up_button">Сохранить</div>
                <div @click="exit" class="pop_up_button">Выйти</div>
            </div>
        </div>

        <div class="opacity">
            <div class="grid" id="grid">
                <div class="grid_element number" id="test_field">1</div>
                <div class="grid_element number">2</div>
                <div class="grid_element" v-for="option in options" v-bind:style="option.color">{{ option.text }}</div>
                <div class="grid_element plus" @click="add_product">+</div>
            </div>
        </div>
        
        

        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

        <script>
            let grid = new Vue({
            el: '#grid',
            data: {
                    options: [
                    { text: 'СберАптека', value: '1', color:"background:red" },
                    { text: 'ДомКлик', value: '2', color:"background:purple" },
                    ]
                },
            methods: {
                add_product: function () {
                    flow_window.is_add = true;
                }
            }
            })
        </script>

        <script>
            let flow_window = new Vue({
            el: '#pop_up',
            data: {
                    is_add: false,
                },
            methods: {
                create_product: function () {
                    var input = document.getElementById("pop_up_input");
                    grid.options.push({ text: input.value, value: grid.options.lenght, color:"background:" + String(document.getElementById('hex').value) });
                    input.value = "";
                    this.is_add = false;
                },
                exit: function () {
                    this.is_add = false;
                }
            }
            })
        </script>

        <script>
            var app = new Vue({
            el: '#to_masters',
                methods: {
                    go_to_masters: function () {
                        window.location.href = "master.html";
                    }
                }
            })
        </script>
        <script>
            document.addEventListener("DOMNodeInserted", function (event) {
                var product = document.getElementById("color_example"), 
            r = document.querySelector('#r'),
            g = document.querySelector('#g'),
            b = document.querySelector('#b'),
            r_out = document.querySelector('#r_out'),
            g_out = document.querySelector('#g_out'),
            b_out = document.querySelector('#b_out'),
            hex_out = document.querySelector('#hex');

            function setColor(){
            var r_hex = parseInt(r.value, 10).toString(16),
                g_hex = parseInt(g.value, 10).toString(16),
                b_hex = parseInt(b.value, 10).toString(16),
                hex = "#" + pad(r_hex) + pad(g_hex) + pad(b_hex);
                product.style.backgroundColor = hex; 
            hex_out.value = hex;
            }

            function pad(n){
            return (n.length<2) ? "0"+n : n;
            }

            r.addEventListener('change', function() {
            setColor();
            r_out.value = r.value;
            }, false);

            r.addEventListener('input', function() {
            setColor();
            r_out.value = r.value;
            }, false);

            g.addEventListener('change', function() {
            setColor();
            g_out.value = g.value;
            }, false);

            g.addEventListener('input', function() {
            setColor();
            g_out.value = g.value;
            }, false);

            b.addEventListener('change', function() {
            setColor();
            b_out.value = b.value;
            }, false);

            b.addEventListener('input', function() {
            setColor();
            b_out.value = b.value;
            }, false);
                
            }, false);
        </script>
    </body>
</html>